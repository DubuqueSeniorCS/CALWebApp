<html>

<head>
    <link rel="stylesheet" href="labreport.css">
    <link rel="stylesheet" type="text/css" href="./css/sabrinacss.css">
    <link rel="stylesheet" type="text/css" href="./css/normalize.css">
    <link rel="stylesheet" type="text/css" href="./css/style.css">
    <title>Speedway Lab</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.3.2/jspdf.min.js"></script>
</head>

<body>

    <h1 id="title">Lab Report</h1>

    <h2 id="challenge-type">Speedway Challenge </h2>

    <p>What alters the speed of the car?</p>
    
    <label> What are you going to try?</label>

    <textarea id="plan" placeholder="Record your plan and predictions here!"></textarea>

    <br>
    <div id="time"></div>
    <button id="startButton" onClick=getTimeStart()>Start</button>
    <button onClick="getStopTime()">Stop</button>
    <button onClick="restart()">Restart</button>
    <label> How fast did your car go? Hint: use the timer! </label>

    <textarea id="prediction" placeholder="Record your results here!"></textarea>


    <input type="file" onchange="previewFile()">
    <br>
    <img src="" height="200" alt="Image preview...">
    <br>
    <button onclick="printToPdf()">Save my report!</button>

    <h1>Ready to move on to something new?</h1>
    <h2>CLICK BELOW!</h2>
 
    <br>
    <a href="climbingLabReport.html"><img src="./images/rockClimbing.png" format=750w width="350"></a>
    <br>
    <br>
    <a href = "index.html">
    <button>Click Here to Return Home!</button>
    </a>
    <br>
    <script>
        var imgData;

           function previewFile() {
            var preview = document.querySelector('img'); //selects the query named img
            var file = document.querySelector('input[type=file]').files[0]; //sames as here
            var reader = new FileReader();
            reader.onloadend = function () {
                preview.src = reader.result;
            }
            if (file) {
                reader.readAsDataURL(file); //reads the data as a URL
            } else {
                preview.src = "";
            }
        }

        var timer = new Date();
        var startTime = 0;
        var stopTime = 0;
        var tenthseconds = 0;
        var seconds = 0;
        setInterval(displayTime, 100);
        var isStopped = false;

        function displayTime() {
            timer = new Date();
            if (startTime != 0 && !isStopped) {
                stopTime = timer.getTime();
                var elapsedseconds = stopTime - startTime;
                tenthseconds = Math.floor(elapsedseconds / 100) % 10;
                seconds = Math.floor(elapsedseconds / 1000);
            }
            document.getElementById("time").innerHTML =
                seconds + ":" + tenthseconds + " seconds";
            console.log(isStopped);
        }

        function getTimeStart() {
            console.log("Start");
            timer = new Date();
            startTime = timer.getTime();
            console.log(startTime);
            document.getElementById("startButton").innerHTML = "Started...";
        }

        function getStopTime() {
            isStopped = true;
            document.getElementById("startButton").innerHTML = "Start";
        }
        var timeToDisplay = stopTime - startTime;

        function restart() {
            isStopped = false;
            startTime = 0;
            seconds = 0;
            tenthseconds = 0;
            document.getElementById("startButton").innerHTML = "Start";
        }

        function printToPdf() {
            var doc = new jsPDF();
            doc.setFontSize(35);
            doc.text(25, 25, 'Speedway Challenge');
            doc.text(25, 35, 'Lab Report');
            doc.setFontSize(24);
            doc.text(25, 45, 'Goal: Make the car go fast');
            doc.text(25, 55, 'What did you try?');
            doc.text(25, 65, document.getElementById("plan").value);
            doc.text(25, 75, 'What happened when you tested your plan?');
            doc.text(25, 85, document.getElementById("prediction").value);
            doc.addImage(imgData, 'JPEG', 15, 40, 180, 160);
            doc.save('speedwaylab.pdf');
        }

        function previewFile() {
            var preview = document.querySelector('img'); //selects the query named img
            var file = document.querySelector('input[type=file]').files[0]; //sames as here
            var reader = new FileReader();
            reader.onloadend = function () {
                preview.src = reader.result;
                imgData = reader.result;
            }
            if (file) {
                reader.readAsDataURL(file); //reads the data as a URL
            } else {
                preview.src = "";
            }
        }
    </script>
</body>

</html>
